<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographic: Lance & Apache Iceberg - Synergizing Data Architectures</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1F2937;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 450px;
            }
        }
        .gradient-text {
            background: linear-gradient(to right, #0079FF, #004AAD);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .flow-arrow {
            font-size: 2rem;
            line-height: 1;
            color: #89CFF3;
        }
        .llm-button {
            background-color: #0079FF;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease;
            cursor: pointer;
            border: none;
        }
        .llm-button:hover {
            background-color: #004AAD;
        }
        .llm-button:disabled {
            background-color: #A2D2FF;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <h2 class="text-xl font-bold text-gray-800">Lance <span class="font-light">&</span> Iceberg</h2>
            <div class="hidden md:flex space-x-6">
                <a href="#intro" class="text-gray-600 hover:text-[#0079FF] transition">Introduction</a>
                <a href="#comparison" class="text-gray-600 hover:text-[#0079FF] transition">Comparison</a>
                <a href="#architecture" class="text-gray-600 hover:text-[#0079FF] transition">Architecture</a>
                <a href="#integration" class="text-gray-600 hover:text-[#0079FF] transition">Integration</a>
                <a href="#outlook" class="text-gray-600 hover:text-[#0079FF] transition">Outlook</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="intro" class="text-center py-12 md:py-20">
            <h1 class="text-4xl md:text-6xl font-black mb-4"><span class="gradient-text">Synergizing Data Architectures</span></h1>
            <p class="text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto mb-8">Unifying large-scale analytics and high-performance AI is the next frontier. Discover how Apache Iceberg and Lance are not competitors, but powerful complements in building the AI-Native Lakehouse.</p>
            <div class="flex justify-center items-center space-x-8 text-5xl md:text-6xl">
                <div class="text-center">
                    <span title="Apache Iceberg">üßä</span>
                    <p class="text-lg font-semibold mt-2">Iceberg</p>
                    <p class="text-sm text-gray-500">Analytics Foundation</p>
                </div>
                <div class="text-5xl font-light text-gray-400">+</div>
                <div class="text-center">
                    <span title="Lance">üöÄ</span>
                    <p class="text-lg font-semibold mt-2">Lance</p>
                    <p class="text-sm text-gray-500">AI/ML Accelerator</p>
                </div>
            </div>
        </section>

        <section id="players" class="py-12">
             <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-8 transform hover:scale-105 transition-transform duration-300">
                    <h3 class="text-3xl font-bold text-[#004AAD] mb-4">üßä Apache Iceberg</h3>
                    <p class="text-gray-600 mb-6">The open table format for huge analytic datasets in data lakes. Iceberg brings the reliability of SQL tables with ACID transactions, schema evolution, and time travel to your data lake.</p>
                    <ul class="space-y-3">
                        <li class="flex items-center"><span class="text-xl mr-3">‚úÖ</span> <strong>ACID Compliance:</strong> Guarantees data integrity at scale. <button class="llm-button text-sm ml-2" onclick="explainConcept('ACID Compliance', 'acidExplanation')">‚ú® Explain</button></li>
                        <li class="text-gray-600 text-sm mt-1 mb-2 hidden" id="acidExplanation"></li>
                        <li class="flex items-center"><span class="text-xl mr-3">‚è≥</span> <strong>Time Travel:</strong> Query historical data and rollback changes.</li>
                        <li class="flex items-center"><span class="text-xl mr-3">‚öôÔ∏è</span> <strong>Broad Engine Support:</strong> Works with Spark, Trino, Flink, and more.</li>
                        <li class="flex items-center"><span class="text-xl mr-3">üîç</span> <strong>Optimized for Scans:</strong> Excels at large-scale analytical queries.</li>
                    </ul>
                </div>
                 <div class="bg-white rounded-xl shadow-lg p-8 transform hover:scale-105 transition-transform duration-300">
                    <h3 class="text-3xl font-bold text-[#0079FF] mb-4">üöÄ Lance</h3>
                    <p class="text-gray-600 mb-6">A modern, AI-native columnar format for ML and vector search. Lance is built for performance, optimized for multimodal data, and designed for the unique demands of AI workloads.</p>
                    <ul class="space-y-3">
                        <li class="flex items-center"><span class="text-xl mr-3">‚ö°Ô∏è</span> <strong>Fast Random Access:</strong> Up to 100x faster than Parquet.</li>
                        <li class="flex items-center"><span class="text-xl mr-3">üß†</span> <strong>Vector Search:</strong> Sub-millisecond nearest neighbor search. <button class="llm-button text-sm ml-2" onclick="explainConcept('Vector Search', 'vectorExplanation')">‚ú® Explain</button></li>
                        <li class="text-gray-600 text-sm mt-1 mb-2 hidden" id="vectorExplanation"></li>
                        <li class="flex items-center"><span class="text-xl mr-3">üì∏</span> <strong>Multimodal Data:</strong> Natively handles images, video, text, and vectors.</li>
                         <li class="flex items-center"><span class="text-xl mr-3">üì¶</span> <strong>Zero-Copy Versioning:</strong> Automatic, efficient data versioning for ML.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="comparison" class="py-12 md:py-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold">Complementary Powers, Not Competing Forces</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mt-4">Instead of overlapping, Lance and Iceberg fill crucial gaps for each other. Iceberg provides a stable, governed foundation, while Lance delivers the specialized performance needed for modern AI.</p>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-4 md:p-8">
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </section>

        <section id="architecture" class="py-12 md:py-20 bg-gray-50 rounded-xl">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold">The AI-Native Lakehouse Architecture</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mt-4">In an integrated system, Iceberg manages the core data lake, providing governance and reliability. Specialized AI/ML pipelines then transform and load data into Lance for high-performance vector search and model training.</p>
            </div>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-8 md:space-y-0 md:space-x-8 text-center">
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-[#89CFF3]">
                    <h4 class="font-bold text-lg">S3 Data Lake</h4>
                    <p class="text-sm text-gray-500">Underlying Storage</p>
                </div>
                <div class="flow-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-[#004AAD]">
                    <h4 class="font-bold text-lg">üßä Iceberg Tables</h4>
                    <p class="text-sm text-gray-500">ACID, Governance, History</p>
                </div>
                 <div class="flow-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-[#0079FF]">
                    <h4 class="font-bold text-lg">üöÄ Lance Datasets</h4>
                    <p class="text-sm text-gray-500">Vector Search, Random Access</p>
                </div>
                 <div class="flow-arrow transform md:rotate-0 rotate-90">‚Üí</div>
                <div class="bg-green-100 border-green-500 border-t-4 p-6 rounded-lg shadow-md">
                    <h4 class="font-bold text-lg text-green-800">AI Applications</h4>
                    <p class="text-sm text-green-600">Inference & Training</p>
                </div>
            </div>
        </section>

        <section id="integration" class="py-12 md:py-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold">Forging the Alliance: Two Integration Pathways</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mt-4">Integration is actively being explored in two primary ways, allowing organizations to leverage the strengths of both technologies within a unified system.</p>
                <button class="llm-button mt-6" id="generateUseCaseBtn">‚ú® Generate a Combined Use Case</button>
                <div id="useCaseOutput" class="bg-white rounded-xl shadow-lg p-6 mt-8 text-left hidden">
                    <p class="text-gray-700 leading-relaxed" id="useCaseText"></p>
                    <div id="useCaseLoading" class="hidden text-center text-gray-500 mt-4">Generating...</div>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h3 class="font-bold text-xl mb-4 text-[#004AAD]">Pathway 1: Lance as a File Format</h3>
                    <p class="text-gray-600 mb-6">Iceberg's metadata layer points directly to Lance data files instead of Parquet. This extends Iceberg's governance to ML-optimized data.</p>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-2">
                        <div class="bg-[#A2D2FF] text-white p-3 rounded font-semibold">Iceberg Table Metadata</div>
                        <div class="pl-4 text-2xl">‚Üì</div>
                        <div class="bg-[#BDE0FE] text-gray-800 p-3 rounded font-semibold ml-4">Manifest List</div>
                        <div class="pl-8 text-2xl">‚Üì</div>
                        <div class="bg-[#0079FF] text-white p-3 rounded font-semibold ml-8">file.lance</div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h3 class="font-bold text-xl mb-4 text-[#004AAD]">Pathway 2: Unified Catalog Integration</h3>
                    <p class="text-gray-600 mb-6">An Iceberg-compatible catalog (like a REST catalog) is extended to understand and manage LanceDB tables, providing a single pane of glass.</p>
                     <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-2 flex flex-col items-center">
                        <div class="bg-[#A2D2FF] text-white p-3 rounded font-semibold w-full text-center">Unified Catalog (e.g., Iceberg REST)</div>
                        <div class="flex w-full justify-around pt-2">
                             <div class="text-2xl">‚Üô</div>
                             <div class="text-2xl">‚Üò</div>
                        </div>
                        <div class="flex w-full justify-around">
                            <div class="bg-[#004AAD] text-white p-3 rounded font-semibold text-center">Iceberg Tables</div>
                            <div class="bg-[#0079FF] text-white p-3 rounded font-semibold text-center">Lance Tables</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="outlook" class="py-12 md:py-20 bg-gray-50 rounded-xl">
             <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold">The Road Ahead: State of the Union</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mt-4">The integration is promising but nascent. Here's a look at the current maturity level.</p>
            </div>
            <div class="max-w-4xl mx-auto space-y-6">
                <div>
                    <div class="flex justify-between mb-1">
                        <span class="text-base font-medium text-[#004AAD]">Community Interest & Discussion</span>
                        <span class="text-sm font-medium text-[#004AAD]">High</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-[#0079FF] h-4 rounded-full" style="width: 90%"></div></div>
                </div>
                 <div>
                    <div class="flex justify-between mb-1">
                        <span class="text-base font-medium text-[#004AAD]">Strategic Partnerships (e.g., Microsoft)</span>
                        <span class="text-sm font-medium text-[#004AAD]">Active</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-[#0079FF] h-4 rounded-full" style="width: 75%"></div></div>
                </div>
                 <div>
                    <div class="flex justify-between mb-1">
                        <span class="text-base font-medium text-[#004AAD]">Standard, Off-the-Shelf Connectors</span>
                        <span class="text-sm font-medium text-[#004AAD]">Emerging</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-[#0079FF] h-4 rounded-full" style="width: 25%"></div></div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white mt-16">
        <div class="container mx-auto px-6 py-4 text-center text-gray-500">
            <p>&copy; 2025 Data Architecture Insights. Infographic generated based on <a href="https://cenz.hashnode.dev/synergizing-data-architectures" target="_blank">analysis of Lance & Apache Iceberg compatibility</a>.</p>
        </div>
    </footer>

    <script>
        function wrapLabel(str, maxWidth) {
            if (str.length <= maxWidth) {
                return str;
            }
            const words = str.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + word).length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = '';
                }
                currentLine += word + ' ';
            }
            lines.push(currentLine.trim());
            return lines;
        }

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
              return label.join(' ');
            }
            return label;
        };

        const comparisonChartCtx = document.getElementById('comparisonChart').getContext('2d');
        const comparisonChart = new Chart(comparisonChartCtx, {
            type: 'bar',
            data: {
                labels: [
                    wrapLabel('Primary Use Case', 16),
                    wrapLabel('Data Type Focus', 16),
                    wrapLabel('Performance Strength', 16),
                    wrapLabel('Data Versioning & History', 16),
                    wrapLabel('Ecosystem & Governance', 16)
                ],
                datasets: [
                    {
                        label: 'üßä Iceberg',
                        data: [4, 5, 4, 5, 5],
                        backgroundColor: '#004AAD',
                        borderColor: '#003B8D',
                        borderWidth: 1
                    },
                    {
                        label: 'üöÄ Lance',
                        data: [5, 4, 5, 4, 3],
                        backgroundColor: '#0079FF',
                        borderColor: '#006AE0',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 5,
                        title: {
                            display: true,
                            text: 'Relative Strength / Specialization'
                        },
                         ticks: {
                            callback: function(value, index, values) {
                                const labels = ['Poor', 'Fair', 'Good', 'Strong', 'Specialized'];
                                return labels[value-1];
                            }
                        }
                    },
                    y: {
                       ticks: {
                           font: {
                               size: 14
                           }
                       }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Comparative Strengths: Iceberg vs. Lance',
                        font: {
                            size: 18
                        },
                        padding: {
                            top: 10,
                            bottom: 30
                        }
                    },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback,
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                const value = context.parsed.x;
                                const strength = ['N/A', 'Poor', 'Fair', 'Good', 'Strong', 'Specialized'][value];
                                label += strength;
                                return label;
                            }
                        }
                    }
                }
            }
        });
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Gemini API Integration
        async function callGeminiAPI(prompt) {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Gemini API returned an unexpected structure:", result);
                    return "Could not generate response. Please try again.";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "Failed to connect to the AI service. Please check your network.";
            }
        }

        // Feature 1: Generate Combined Use Case
        const generateUseCaseBtn = document.getElementById('generateUseCaseBtn');
        const useCaseOutputDiv = document.getElementById('useCaseOutput');
        const useCaseText = document.getElementById('useCaseText');
        const useCaseLoading = document.getElementById('useCaseLoading');

        generateUseCaseBtn.addEventListener('click', async () => {
            generateUseCaseBtn.disabled = true;
            useCaseOutputDiv.classList.remove('hidden');
            useCaseText.textContent = '';
            useCaseLoading.classList.remove('hidden');

            const prompt = `Given Apache Iceberg's strengths in data governance, ACID transactions, and broad engine support for analytical queries, and Lance's strengths in fast random access, vector search, and multimodal data handling for AI/ML workloads, suggest a novel, real-world use case where these two technologies are integrated to solve a complex data problem. Focus on the combined benefits and how each technology contributes.`;

            const generatedText = await callGeminiAPI(prompt);
            useCaseText.textContent = generatedText;
            useCaseLoading.classList.add('hidden');
            generateUseCaseBtn.disabled = false;
        });

        // Feature 2: Explain Concept
        async function explainConcept(concept, outputElementId) {
            const outputElement = document.getElementById(outputElementId);
            const button = outputElement.previousElementSibling.querySelector('button'); // Get the button associated with this explanation

            if (outputElement.classList.contains('hidden')) {
                button.disabled = true;
                outputElement.classList.remove('hidden');
                outputElement.textContent = 'Explaining...';

                const prompt = `Explain "${concept}" in the context of data lakes and modern data architectures, in 2-3 concise sentences.`;
                const explanation = await callGeminiAPI(prompt);
                outputElement.textContent = explanation;
                button.disabled = false;
            } else {
                outputElement.classList.add('hidden');
                outputElement.textContent = '';
            }
        }
    </script>
</body>
</html>
